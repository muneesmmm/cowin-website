<!DOCTYPE html>
<html lang="en">

<head>
  <title>COWIN vaccine finder</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="jQuery/jquery-ui.min.css">
  <script src="jQuery/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="style.css">


</head>

<body>
  <div>
    <nav class="navbar navbar-dark bg-dark">
      <a class="navbar-brand" href="#">
        <img src="./vF.png" width="30" height="30" class="d-inline-block align-top" alt="">
        Co-Vaccine finder
      </a>
    </nav>
    <div>
      <img style="background-size:cover ;width: 100%"
        src="./banner.png"
        alt="">
    </div>

  <div class="container">
    <h2>Check Your Nearest Vaccination Center And Slots Availability</h2>
    <div class="form-group">
      <label for="date">Date</label>
      <input type="text" name="date" id="datepicker"> 
       </div>
    
    <div class="form-group">
      <label for="pin">Search by State:</label>
      <select name="select1" id="select1" class="custom-select sources">
        <option value="17">Kerala</option>
      </select>
    </div>
    <div class="form-group">
      <label for="pin">Search by State:</label>
      <select name="state" id="state" class="custom-select sources">
        <option value="295">Kasaragod</option>
        <option value="297">Kannur</option>
        <option value="299">Wayanad</option>
        <option value="305">Kozhikode</option>
        <option value="302">Malappuram</option>
        <option value="308">Palakkad</option>
        <option value="303">Thrissur</option>
        <option value="307">Ernakulam</option>
        <option value="306">Idukki</option>
        <option value="301">Alappuzha</option>
        <option value="300">Pathanamthitta</option>
        <option value="304">Kottayam</option>
        <option value="298">Kollam</option>
        <option value="296">Thiruvananthapuram</option>

      </select>
    </div>
    <button type="button" id="button1" class="btn btn-primary">Search By Dist</button>
    <table class="table" id="sessions">
      <thead>
        <tr>
          <th>Name</th>
          <th>Avileble</th>
          <th>Age</th>
          <th>Dose 1</th>
          <th>Dose 2</th>
          <th>Vaccine</th>
          <th>Fee</th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>

  </div>
  <script>
    
    $(document).ready(function () {
      $( "#datepicker" ).datepicker({ dateFormat: 'dd-mm-yy' });
      $("#button1").click(function () {
      var dates=$( "#datepicker" ).val()
        console.log(dates);
        var dist = $('#state').find(":selected").val();
        console.log(dist);
        if (dist == '' || dist == undefined) {
          alert('please select your district')
        }

        $.get("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id=" + dist + "&date="+dates+"", function (data, status) {
          var result = [];
          result = data.sessions;
          console.log(result);
          if (result) {
            for (var i = 0; i < result.length; i++) {

              var resultData = {}
              resultData = result[i]
              console.log(resultData);
              if (resultData.allow_all_age == true && resultData.min_age_limit == 18) {
                age = "18 & above"
              } else if (resultData.min_age_limit == 45) {
                age = "45"
              } else {
                age = "18"
              }
              console.log(age);
              if(resultData.available_capacity > 0 || resultData.available_capacity  ){
              $('#sessions tbody').append('<tr class="child"><td>' + resultData.name + '</td><td>' + resultData.available_capacity + '</td><td>' + age + '</td><td>' + resultData.available_capacity_dose1 + '</td><td>' + resultData.available_capacity_dose2 + '</td><td>' + resultData.vaccine + '</td><td>' + resultData.fee_type + '</td></tr>');
            }
            }
          }
        });
      });

    });


  </script>
</body>

</html>
